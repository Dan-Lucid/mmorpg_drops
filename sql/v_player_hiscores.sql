CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v_player_hiscores` AS select dense_rank() OVER (ORDER BY `playercores`.`Points` desc )  AS `Ranking`,`playercores`.`PlayerName` AS `PlayerName`,`playercores`.`Points` AS `Points` from (select distinct `player`.`PlayerName` AS `PlayerName`,coalesce(sum((`item`.`PointValue` * count(`record`.`ItemID`))) OVER (PARTITION BY `record`.`PlayerID` ) ,0) AS `Points` from ((`player` left join `record` on((`player`.`PlayerID` = `record`.`PlayerID`))) left join `item` on((`record`.`ItemID` = `item`.`ItemID`))) group by `player`.`PlayerID`,`record`.`ItemID` order by `Points` desc) `playercores`;
