CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v_player_hiscores` AS select dense_rank() OVER (ORDER BY `playerscores`.`Points` desc )  AS `Ranking`,`playerscores`.`PlayerName` AS `PlayerName`,`playerscores`.`Points` AS `Points` from (select distinct `players`.`PlayerName` AS `PlayerName`,coalesce(sum((`items`.`PointValue` * count(`records`.`ItemID`))) OVER (PARTITION BY `records`.`PlayerID` ) ,0) AS `Points` from ((`players` left join `records` on((`players`.`PlayerID` = `records`.`PlayerID`))) left join `items` on((`records`.`ItemID` = `items`.`ItemID`))) group by `players`.`PlayerID`,`records`.`ItemID` order by `Points` desc) `playerscores`;
